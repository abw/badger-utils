<!DOCTYPE html><html><head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/utils/sort.js | Badger Utils</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<link rel="stylesheet" href="./inject/css/0-badger.css"><meta name="description" content="Javascript utility modules"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Badger Utils"><meta property="twitter:description" content="Javascript utility modules"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./" style="display: flex; align-items: center;"><img src="./image/brand_logo.svg" style="width:34px;"></a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/abw/badger-utils"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#utils">utils</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-firstValue">firstValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hasValue">hasValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-haveValue">haveValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isArray">isArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isBoolean">isBoolean</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isFloat">isFloat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isFunction">isFunction</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isInteger">isInteger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isNull">isNull</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isNumber">isNumber</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isObject">isObject</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isRegExp">isRegExp</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isString">isString</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isUndefined">isUndefined</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-noValue">noValue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fail">fail</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-failMsg">failMsg</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-rethrow">rethrow</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-format">format</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-maybeFunction">maybeFunction</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-defaultLocale">defaultLocale</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-doNothing">doNothing</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-commas">commas</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-currency">currency</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatNumber">formatNumber</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-range">range</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-setNumberDefaults">setNumberDefaults</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-extract">extract</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hash">hash</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-objMap">objMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-remove">remove</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-selector">selector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ascendingOrder">ascendingOrder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-booleanField">booleanField</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-booleanSort">booleanSort</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-descendingOrder">descendingOrder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-integerField">integerField</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-integerSort">integerSort</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-multiSort">multiSort</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-numberField">numberField</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-numberSort">numberSort</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-stringField">stringField</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-stringSort">stringSort</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Inflect">Inflect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-capitalise">capitalise</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-capitaliseWords">capitaliseWords</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-inflect">inflect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-joinList">joinList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-joinListAnd">joinListAnd</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-joinListOr">joinListOr</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-plural">plural</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-singular">singular</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-snakeToCamel">snakeToCamel</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-snakeToStudly">snakeToStudly</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-splitHash">splitHash</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-splitLines">splitLines</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-splitList">splitList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-debounce">debounce</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-sleep">sleep</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-entries">entries</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-keys">keys</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-objSubset">objSubset</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-values">values</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-sortOrders">sortOrders</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-sortTypes">sortTypes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-capitalize">capitalize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-capitalizeWords">capitalizeWords</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-pluralise">pluralise</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-pluralize">pluralize</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/utils/sort.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import { isFunction, isString } from "./assert.js";
import { fail } from "./error.js";
import { splitList } from "./text.js";

/**
 * Function to extract a boolean field from an object.
 * @param {Object} obj - object containing data
 * @param {String} field - field to return as boolean
 * @return {Boolean} - Boolean value from object
 * @example
 * booleanField({ a: 1 }, "a");     // true
 */
export const booleanField = (obj, field) =&gt;
  Boolean(obj[field]||0)


/**
 * Function to extract an integer field from an object.  Uses `parseInt()` to
 * coerce non-integer values (e.g. numbers in strings) to an integer.
 * @param {Object} obj - object containing data
 * @param {String} field - field to return as integer
 * @return {Integer} - integer value from object
 * @example
 * integerField({ a: "10" }, "a");     // 10
 */
export const integerField = (obj, field) =&gt;
  parseInt(obj[field]||0)

/**
 * Function to extract a number field from an object.  Uses `parseFloat()` to
 * coerce non-number values (e.g. numbers in strings) to floats.
 * @param {Object} obj - object containing data
 * @param {String} field - field to return as float
 * @return {Float} - floating point number from object
 * @example
 * numberField({ pi: "3.14" }, "pi");     // 3.14
 */
export const numberField = (obj, field) =&gt;
  parseFloat(obj[field]||0)

/**
 * Function to extract a string field from an object.  Uses `toString()` to
 * coerce non-string values (e.g. numbers) to strings.
 * @param {Object} obj - object containing data
 * @param {String} field - field to return as string
 * @return {Float} - string value from object
 * @example
 * numberField({ pi: 3.14 }, "pi");     // "3.14"
 */
export const stringField = (obj, field) =&gt;
  (obj[field]||'').toString()

/**
 * Sort function generator for sorting objects by an integer field.
 * Takes a single field name and returns a sort function which will sort
 * objects by that field.
 * @param {String} field - field to return as string
 * @return {Function} - sort function to sort objects by the named integer field
 * @example
 * const people = [
 *   { name: "Fred",   age: 18 },
 *   { name: "Shaggy", age: 17 },
 *   { name: "Daphne", age: 16 },
 *   { name: "Velma",  age: 15 },
 * ];
 * const sortByAge = integerSort('age');
 * const sorted = people.sort(sortByAge); // Velma, Daphne, Shaggy, Fred
 */
export const integerSort = field =&gt; (a, b) =&gt; {
  return integerField(a, field) - integerField(b, field);
}

/**
 * Sort function generator for sorting objects by a number field.
 * Takes a single field name and returns a sort function which will sort
 * objects by that field.
 * @param {String} field - field to return as string
 * @return {Function} - sort function to sort objects by the named number field
 * @example
 * const constants = [
 *   { name: "pi",   value: 3.14  },
 *   { name: "e",    value: 2.718 },
 *   { name: "phi",  value: 1.618 },
 * ];
 * const sortByValue = numberSort('value');
 * const sorted = constants.sort(sortByValue); // phi, e, pi
 */
export const numberSort = field =&gt; (a, b) =&gt; {
  return numberField(a, field) - numberField(b, field);
}

/**
 * Sort function generator for sorting objects by a string field.
 * Takes a single field name and returns a sort function which will sort
 * objects by that field.
 * @param {String} field - field to return as string
 * @return {Function} - sort function to sort objects by the named string field
 * @example
 * const constants = [
 *   { name: "pi",   value: 3.14  },
 *   { name: "e",    value: 2.718 },
 *   { name: "phi",  value: 1.618 },
 * ];
 * const sortByName = stringSort('name');
 * const sorted = constants.sort(sortByName); // e, phi, pi
 */
export const stringSort = field =&gt; (a, b) =&gt; {
  let c = stringField(a, field).toLowerCase();
  let d = stringField(b, field).toLowerCase();
  return c &gt; d ? 1 : d &gt; c ? -1 : 0;
}

/**
 * Sort function generator for sorting objects by a boolean field.
 * Takes a single field name and returns a sort function which will sort
 * objects by that field.
 * @param {String} field - field to return as string
 * @return {Function} - sort function to sort objects by the named boolean field
 * @example
 * const words = [
 *   { name: "no",   truth: false  },
 *   { name: "yes",  truth: 1 },
 * ];
 * const sortByBool = booleanSort('truth');
 * const sorted = words.sort(sortByBool); // yes, no
 */
export const booleanSort = field =&gt; (a, b) =&gt; {
  let c = booleanField(a, field)
  let d = booleanField(b, field)
  return (c === d) ? 0 : c ? 1 : -1;
}

/**
 * Lookup table mapping sort types to their functions.
 */
export const sortTypes = {
  num:      numberSort,
  int:      integerSort,
  str:      stringSort,
  bool:     booleanSort,
  number:   numberSort,
  integer:  integerSort,
  string:   stringSort,
  boolean:  booleanSort,
};

/**
 * Do-nothing function provided for completeness.  It expects to be passed a sort
 * function that, by default, sorts in ascending order and it simply returns that
 * function unmodified.
 * @param {Function} fn - sort function
 * @return {Function} - the same sort function
 * @example
 * const sortByName = stringSort('name');
 * const sortByNameAsc = ascendingOrder(sortByName);
 */
export const ascendingOrder  = fn =&gt; fn

/**
 * Inverting function that converts a sort function that sorts in ascending order to
 * one that sorts in descending order.  It does this by swapping the `a` and `b`
 * arguments passed to the function.
 * @param {Function} fn - function to sort in ascending order
 * @return {Function} - wrapper around the function to sort in descending order
 * @example
 * const sortByName = stringSort('name');
 * const sortByNameDesc = descendingOrder(sortByName);
 */
export const descendingOrder = fn =&gt; (a, b) =&gt; fn(b, a)

/**
 * Lookup table mapping sort orders to their functions.
 */
export const sortOrders = {
  asc:        ascendingOrder,
  desc:       descendingOrder,
  ascending:  ascendingOrder,
  descending: descendingOrder,
};


/**
 * Sort function generator for sorting objects by multiple fields.
 * The specification can be either an array of sort functions, or be
 * specification used to construct those functions.  The specification
 * should be a whitespace delimited string in which each
 * component is the field name, optional data type and optional sort order,
 * each separated by a colon.
 * In the simple case, the data type is assumed be be `string` and the sort
 * order defaults to `asc`.  e.g. `surname forename` is the short form of
 * `surname:string:asc forename:string:asc`.  The data type can be one of
 * `string` (default), `integer` or `number` and the sort order can be `asc`
 * (default) for ascending order or `desc` for descending.
 * Returns a function which sorts an array of object by those fields.
 * @param {String} spec - sort specification
 * @return {Function} - sort function to sort objects by the named string field
 * @example
 * const people = [
 *   { forename: "John", surname: "Smith", age: 28 },
 *   { forename: "Jack", surname: "Smith", age: 30 },
 *   { forename: "John", surname: "Smith", age: 25 },
 *   { forename: "John", surname: "Jones", age: 32 },
 * ];
 * const sortByNameAndAge = multiSort('surname forename age:integer:desc');
 * const sorted = people.sort(sortByNameAndAge); // John Jones 32, Jack Smith 30, John Smith 28, John Smith 25
 */
export const multiSort = spec =&gt; {
  const sorts = splitList(spec);
  const funcs = sorts.map(
    sort =&gt; {
      if (isFunction(sort)) {
        return sort;
      }
      else if (isString(sort)) {
        const match = sort.match(/^(\w+)(?::(\w+))?(?::(\w+))?$/)
          || fail(`Invalid sort field: ${sort}`);
        const sorter = sortTypes[match[2] || 'string']
          || fail(`Invalid sort type "${match[2]}" in sort field: ${sort}`);
        const order = sortOrders[match[3] || 'asc']
          || fail(`Invalid sort order "${match[3]}" in sort field: ${sort}`);
        return order(sorter(match[1]));
      }
      else {
        fail(`Invalid sort field: ${sort}`);
      }
    }
  );
  return (a, b) =&gt; {
    for (let i = 0; i &lt; funcs.length; i++) {
      const sortFunc = funcs[i];
      const cmp = sortFunc(a, b);
      if (cmp !== 0) {
        return cmp;
      }
    }
    return 0;
  }
}</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>


</body></html>